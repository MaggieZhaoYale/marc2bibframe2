<?xml version="1.0" encoding="UTF-8"?>

<x:description xmlns:x="http://www.jenitennison.com/xslt/xspec"
               xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
               xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
               xmlns:marc="http://www.loc.gov/MARC21/slim"
               xmlns:bf="http://id.loc.gov/ontologies/bibframe/"
               xmlns:bflc="http://id.loc.gov/ontologies/bibframe/lc-extensions/"
               stylesheet="../xsl/marc2bibframe2.xsl" xslt-version="1.0">

  <x:import href="validation.xspec"/>
  <x:import href="ConvSpec-LDR.xspec"/>
  <x:import href="ConvSpec-200-247not240-Titles.xspec"/>

  <x:scenario label="Trival tests">

    <x:scenario label="Single record (marc.xml)...">
      <x:context href="data/marc.xml"/>
      <x:expect label="should return one RDF node" test="count(/rdf:RDF) = 1"/>
      <x:expect label="and one Work node" test="count(/rdf:RDF/bf:Work) = 1"/>
      <x:expect label="and one Instance node" test="count(/rdf:RDF/bf:Instance) = 1"/>
      <x:expect label="Work should have control number as rdf:about" test="/rdf:RDF/bf:Work/@rdf:about = 'http://example.org/13600108work'"/>
      <x:expect label="Instance should have control number as rdf:about" test="/rdf:RDF/bf:Instance/@rdf:about = 'http://example.org/13600108instance'"/>
    </x:scenario>

    <!--
        for this test to pass, need to increase the node limit for creating
        files in xspec source: src/compiler/generate-tests-utils.xsl line 572
    -->
    <x:scenario label="Collection of records (../dataset/loc_general.xml)...">
      <x:context href="../dataset/loc_general.xml"/>
      <x:expect label="should also return one RDF node" test="count(/rdf:RDF) = 1" />
      <x:expect label="with at least 99 Work nodes" test="count(/rdf:RDF/bf:Work) >= 99" />
      <x:expect label="and at least 99 Instance nodes" test="count(/rdf:RDF/bf:Instance) >= 99" />
    </x:scenario>

  </x:scenario>
  
</x:description>
